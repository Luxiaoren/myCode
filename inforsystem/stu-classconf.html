<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="css/public.css">
    <link rel="stylesheet" href="css/common.css">
    <link rel="stylesheet" type="text/css" href="css/stu-style-classconf.css"/>
    <link rel="stylesheet" href="https://cdn.bootcss.com/bootstrap/4.0.0/css/bootstrap.min.css"
          integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

    <title>学生-家庭作业</title>
</head>
<body>
<header>
    <a href="">大学信息基础作业管理系统</a>
    <div id="setting">
        <a href=""></a>
        <div id="bott">
            <i href="#">修改密码</i>
            <i href="#">退出</i>
        </div>
    </div>
</header>
<aside>
    <div class="home">
        <a href="main.html" class="top"><img src="image/i-2.png" alt=""></a>
    </div>
    <a href="#" id="stu" onclick="changelist(this,stulist,true);return false;">学生模块</a>
    <ul id="stulist">
        <li><a href="stu-basefile.html">基本资料</a></li>
        <li><a href="stu-classdate.html">班级情况</a></li>
        <li><a href="stu-homewok.html">家庭作业</a></li>
        <li><a href="">班级通知</a></li>
    </ul>
    <a href="#" id="tec" onclick="changelist(this,teclist,false);return false;">教师模块</a><!--false表示初始高度为隐藏高度时-->
    <ul id="teclist">
        <li><a href="tec-basefile.html">基本资料</a></li>
        <li><a href="tec-classdate.html">班级情况</a></li>
        <li><a href="tec-classmate.html">人员管理</a></li>
        <li><a href="tec-homework.html">班级作业</a></li>
    </ul>
    <a href="#" id="admin" onclick="changelist(this,adminlist,false);return false;">管理员模块</a>
    <ul id="adminlist">
        <li><a href="admin-peo.html">人员信息</a></li>
        <li><a href="admin-abouts.html">关于我们</a></li>
        <li><a href="admin-contacts.html">联系我们</a></li>
    </ul>
</aside>
<div id="main">
    <div class="bar">
        学生 > 班级通知
    </div>
    <div class="conf margin">
        <h4>班级通知</h4>
        <div class="confContent">
            <ul id="con-ul">
                <li>
                    <p>测试标题测试标题测试标题</p>
                    <span data-span-flag="right">2-10103-13</span>
                </li>

            </ul>

        </div>

    </div>
    <div id="limit">
        <button></button>
    </div>
</div>
<div class="modal fade" id="exampleModalLong" tabindex="-1" role="dialog" aria-labelledby="exampleModalLongTitle"
     aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLongTitle">Modal title</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body" id="modal-body">
                ...
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>
</body>
<script src="https://cdn.bootcss.com/jquery/3.2.1/jquery.slim.min.js"
        integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
        crossorigin="anonymous"></script>
<script src="https://cdn.bootcss.com/popper.js/1.12.9/umd/popper.min.js"
        integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
        crossorigin="anonymous"></script>
<script src="https://cdn.bootcss.com/bootstrap/4.0.0/js/bootstrap.min.js"
        integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
        crossorigin="anonymous"></script>

<script src="js/style.js"></script>
<script src="js/common.js"></script>
<script src="bjs/jquery.js"></script>
<script src="js/logout.js"></script>
<script>
    // window.onload = function () {
    //     var oul = document.querySelector("#con-ul");
    //     var oli = document.querySelectorAll('#con-ul li');
    //     oul.onclick = function (ev) {
    //         ev = ev || window.event;
    //         var target = ev.target || ev.srcElement;
    //         // alert(ev.target.nodeName);
    //         if (target.nodeName === "SPAN") {
    //             if (target.getAttribute('data-span-flag') === 'right') {
    //                 for (var i = 0; i < oli.length; i++) {
    //                     oli[i].children[1].style.background = 'url(image/i-10.png) no-repeat center';
    //                     oli[i].children[1].style.backgroundSize = '40%';
    //                     oli[i].children[0].style['text-indent'] = '20px';
    //                     oli[i].style['height'] = '40px';
    //                     oli[i].children[1].setAttribute('data-span-flag', 'right');
    //
    //                 }
    //                 target.style.background = 'url(image/i-11.png) no-repeat center';
    //                 target.style.backgroundSize = '38% 60%';
    //                 // target.previousElementSibling.style['text-indent']='300px';
    //                 target.parentNode.style.height = '300px';
    //                 // target.style.transition='all 2s';
    //
    //                 target.setAttribute('data-span-flag', 'down');
    //             } else {
    //                 target.style.background = 'url(image/i-10.png) no-repeat center';
    //                 target.style.backgroundSize = '40%';
    //                 target.previousElementSibling.style['text-indent'] = '20px';
    //                 target.parentNode.style.height = '40px';
    //                 target.setAttribute('data-span-flag', 'right');
    //
    //
    //             }
    //         }
    //     }
    // }

    function F() {
        this.init();
    }

    F.prototype = {
        constructor: F,
        init: function () {
            $("#setting a").html(getCookie("username"));
            url = "backend/Process.php";
            sendValue = "page=stuclassconf";
            this.ajax(url, sendValue).then(function (res) {
                var json = JSON.parse(res);
                // console.log(json);
                // var liNum = 0;
                var str = "";
                for (var i = json.length - 1; i >= 0; i--) {
                    str += `
                            <li data-i="${i}"  data-toggle="modal" data-target="#exampleModalLong">
                                <p>${json[i].title}</p>
                                <span>${json[i].time}</span>
                            </li>
                            `;
                }
                $("ul#con-ul").html(str);
                $("ul#con-ul li").click(function () {
                    var i = $(this).attr("data-i");
                    $("#exampleModalLongTitle").html(json[i].title);
                    $("#modal-body").html(json[i].content);
                })

                // while (liNum <= 4) {
                //
                //     $(`ul#con-ul li:eq(${liNum}) p`).text(json[json.length-liNum-1].title);
                //     $(`ul#con-ul li:eq(${liNum}) div`).text(json[json.length-liNum-1].content);
                //
                //     // $(`ul#con-ul li:eq(0) p`).html(json[0].title);
                //     // $(`ul#con-ul li:eq(0) div`).html(json[0].content);
                //     // console.log(liNum)
                //     liNum += 1;
                // }
                // console.log(liNum+"&")
            })
        },
        ajax: function (url, sendValue) {
            var p = new Promise(function (success, failed) {
                var ajax = new XMLHttpRequest();
                var method = "POST";
                ajax.open(method, url);
                ajax.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
                ajax.send(sendValue);
                ajax.onreadystatechange = function () {
                    if (ajax.readyState === 4 && ajax.status === 200) {
                        var res = ajax.responseText;

                        success(res);
                    } else {
                        if (ajax.readyState === 4 && ajax.status !== 200) {
                            failed("ajax链接失败")
                        }
                    }
                }
            })
            return p;
        }
    }

    if(getCookie("counttype")==="student"){

    new F();
    }else{
        $("#limit").show();
    }


</script>
</html>